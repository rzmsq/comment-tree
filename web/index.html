<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CommentTree UI</title>
    <style>
        body { font-family: sans-serif; margin: 2em; }
        #comments-list { list-style-type: none; padding: 0; }
        .comment-item { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; border-radius: 5px; }
        .comment-item button { float: right; }
        form { margin-bottom: 2em; }
    </style>
</head>
<body>

<h1>Comments</h1>

<form id="new-comment-form">
    <input type="text" id="comment-text" placeholder="Write a comment..." required size="50">
    <button type="submit">Add Comment</button>
</form>

<ul id="comments-list"></ul>

<script>
    const commentsList = document.getElementById('comments-list');
    const newCommentForm = document.getElementById('new-comment-form');
    const commentTextInput = document.getElementById('comment-text');

    // Fetch and display all comments
    async function fetchComments() {
        try {
            const response = await fetch('/comments'); // Assumes GET /comments endpoint
            if (!response.ok) throw new Error('Failed to fetch comments');
            const comments = await response.json();

            commentsList.innerHTML = ''; // Clear current list
            comments.forEach(comment => {
                const li = document.createElement('li');
                li.className = 'comment-item';
                li.textContent = comment.text; // Assumes comment object has a 'text' field
                li.dataset.id = comment.id; // Assumes comment object has an 'id' field

                const deleteBtn = document.createElement('button');
                deleteBtn.textContent = 'Delete';
                deleteBtn.onclick = () => deleteComment(comment.id);

                li.appendChild(deleteBtn);
                commentsList.appendChild(li);
            });
        } catch (error) {
            console.error('Error fetching comments:', error);
            commentsList.innerHTML = '<li>Error loading comments.</li>';
        }
    }

    // Create a new comment
    newCommentForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const text = commentTextInput.value;
        if (!text) return;

        try {
            const response = await fetch('/comments', { // Assumes POST /comments endpoint
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text: text }) // Assumes the API expects an object with a 'text' field
            });

            if (!response.ok) throw new Error('Failed to create comment');

            commentTextInput.value = '';
            await fetchComments(); // Refresh the list
        } catch (error) {
            console.error('Error creating comment:', error);
        }
    });

    // Delete a comment
    async function deleteComment(id) {
        if (!confirm('Are you sure you want to delete this comment?')) return;

        try {
            const response = await fetch(`/comments/${id}`, { method: 'DELETE' }); // Assumes DELETE /comments/{id} endpoint
            if (!response.ok) throw new Error('Failed to delete comment');
            await fetchComments(); // Refresh the list
        } catch (error) {
            console.error('Error deleting comment:', error);
        }
    }

    // Initial load
    fetchComments();
</script>

</body>
</html>
